<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tycoon Game - Hardcore Edition</title>
    <style>
        /* General styling */
        body {
            font-family: Arial, sans-serif;
            background-color: #f2f2f2;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            flex-direction: column;
        }
        .container {
            background-color: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
            text-align: center;
            width: 300px;
        }
        .button {
            padding: 10px 20px;
            margin: 10px 0;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            background-color: #007bff;
            color: white;
            font-size: 16px;
        }
        .button:hover {
            background-color: #0056b3;
        }
        .progress-bar {
            width: 100%;
            height: 20px;
            background-color: #e0e0e0;
            margin-bottom: 20px;
        }
        .progress-bar-filled {
            height: 100%;
            background-color: #4caf50;
            width: 0;
        }
        .scoreboard-table {
            width: 100%;
            margin-top: 20px;
            border-collapse: collapse;
        }
        .scoreboard-table th, .scoreboard-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        .scoreboard-table th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Tycoon Game - Hardcore Edition</h1>
        <div class="progress-bar">
            <div id="progressBarFilled" class="progress-bar-filled"></div>
        </div>
        <div class="status">
            <p>Money: $<span id="money">0</span></p>
            <p>Business Level: <span id="businessLevel">1</span></p>
            <p>Money per Click: $<span id="earningsPerClick">1</span></p>
            <p>Rebirths: <span id="rebirths">0</span></p>
            <p>Next Rebirth Cost: $<span id="rebirthCost">1000</span></p>
            <p>Speedrun Timer: <span id="speedrunTimer">00:00</span></p>
        </div>
        <button class="button" id="clickButton">Earn Money</button>
        <button class="button upgrade" id="upgradeButton">Upgrade Business - $50</button>
        <button class="button rebirth" id="rebirthButton">Rebirth</button>
        <button class="button gamble" id="gambleButton">Gamble</button>
        <button class="button ultimate-gamble" id="ultimateGambleButton">Ultimate Gamble</button>
        <button class="button" id="startRunButton">Start New Run</button>
    </div>

    <div id="testModeBox">
        <h3>Test Mode Activated</h3>
        <p><strong>Money:</strong> $<span id="testMoney">0</span></p>
        <p><strong>Money per Click:</strong> $<span id="testEarningsPerClick">1</span></p>
        <p><strong>Business Level:</strong> <span id="testBusinessLevel">1</span></p>
        <p><strong>Rebirths:</strong> <span id="testRebirths">0</span></p>
        <label for="winChanceInput">Set Gamble Win Chance (0-1):</label>
        <input type="number" id="winChanceInput" min="0" max="1" step="0.01" value="0.5" />
    </div>

    <div id="scoreboard">
        <h3>Scoreboard</h3>
        <table class="scoreboard-table" id="scoreboardTable">
            <thead>
                <tr>
                    <th>Goal</th>
                    <th>Personal Best</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Reach $1,000,000</td>
                    <td id="goal1PB">Not achieved</td>
                </tr>
                <tr>
                    <td>Rebirth 10 times</td>
                    <td id="goal2PB">Not achieved</td>
                </tr>
                <!-- Add more goals as needed -->
            </tbody>
        </table>
    </div>

    <button id="resetButton">Reset Everything</button>

    <script>
        let money = parseInt(localStorage.getItem("money")) || 0;
        let earningsPerClick = parseInt(localStorage.getItem("earningsPerClick")) || 1;
        let businessLevel = parseInt(localStorage.getItem("businessLevel")) || 1;
        let rebirths = parseInt(localStorage.getItem("rebirths")) || 0;
        let timerStart = null;
        let isRunning = false;
        let runStartTime = 0;
        let runTime = 0;
        let totalProgress = 0; // Total progress for 100%

        // Scoreboard
        const goal1PB = document.getElementById("goal1PB");
        const goal2PB = document.getElementById("goal2PB");

        const moneyDisplay = document.getElementById("money");
        const earningsPerClickDisplay = document.getElementById("earningsPerClick");
        const businessLevelDisplay = document.getElementById("businessLevel");
        const rebirthsDisplay = document.getElementById("rebirths");
        const rebirthCostDisplay = document.getElementById("rebirthCost");
        const speedrunTimerDisplay = document.getElementById("speedrunTimer");
        const progressBarFilled = document.getElementById("progressBarFilled");

        const MONEY_CAP = 100000000000000; // 100 trillion

        // Function to calculate rebirth cost based on rebirth count, but without a cap
        function calculateRebirthCost() {
            let cost = 1000 * Math.pow(2, rebirths);  // Example: Rebirth cost grows exponentially
            return cost;  // No cap on rebirth cost
        }

        function updateSpeedrunTimer() {
            if (isRunning) {
                runTime = Math.floor((Date.now() - runStartTime) / 1000);
                let minutes = Math.floor(runTime / 60);
                let seconds = runTime % 60;
                speedrunTimerDisplay.textContent = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            }
        }

        function startNewRun() {
            money = 0;
            earningsPerClick = 1;
            businessLevel = 1;
            rebirths = 0;
            totalProgress = 0; // Reset total progress
            runStartTime = Date.now();
            isRunning = true;
            updateSpeedrunTimer();
            updateProgressBar();
            saveData();
        }

        function saveData() {
            if (!isRunning) {
                localStorage.setItem("money", money);
                localStorage.setItem("earningsPerClick", earningsPerClick);
                localStorage.setItem("businessLevel", businessLevel);
                localStorage.setItem("rebirths", rebirths);
            }
        }

        function updateProgressBar() {
            const progressPercentage = totalProgress; // This value should be updated as progress is made
            progressBarFilled.style.width = `${progressPercentage}%`;
        }

        function resetEverything() {
            localStorage.clear();
            money = 0;
            earningsPerClick = 1;
            businessLevel = 1;
            rebirths = 0;
            totalProgress = 0;
            speedrunTimerDisplay.textContent = "00:00";
            moneyDisplay.textContent = money;
            earningsPerClickDisplay.textContent = earningsPerClick;
            businessLevelDisplay.textContent = businessLevel;
            rebirthsDisplay.textContent = rebirths;
            rebirthCostDisplay.textContent = calculateRebirthCost();
            updateProgressBar();
        }

        function updateScoreboard() {
            if (money >= 1000000) {
                goal1PB.textContent = `$${money}`;
            }
            if (rebirths >= 10) {
                goal2PB.textContent = `${rebirths} rebirths`;
            }
        }

        document.getElementById("clickButton").onclick = function() {
            money += earningsPerClick;
            if (money > MONEY_CAP) {
                money = MONEY_CAP;  // Cap the money at 100 trillion
            }
            moneyDisplay.textContent = money;

            // Updating progress towards 100%
            totalProgress = Math.min(100, (money / 1000000) * 100);  // Example progress for $1,000,000 goal
            updateProgressBar();
            updateScoreboard();
        };

        document.getElementById("upgradeButton").onclick = function() {
            if (money >= 50) {
                money -= 50;
                earningsPerClick += 5;
                businessLevel += 1;
                moneyDisplay.textContent = money;
                earningsPerClickDisplay.textContent = earningsPerClick;
                businessLevelDisplay.textContent = businessLevel;
                saveData();
            } else {
                alert("Not enough money for upgrade!");
            }
        };

        document.getElementById("rebirthButton").onclick = function() {
            const rebirthCost = calculateRebirthCost();
            if (money >= rebirthCost) {
                money -= rebirthCost;
                rebirths++;
                money += 1000 * rebirths;  // Rebirth reward
                moneyDisplay.textContent = money;
                rebirthsDisplay.textContent = rebirths;
                rebirthCostDisplay.textContent = calculateRebirthCost();
                saveData();
            } else {
                alert("You don't have enough money for a rebirth.");
            }
        };

        document.getElementById("gambleButton").onclick = function() {
            if (money >= 100) {
                const gamblePercentage = Math.random() * (0.5 - 0.1) + 0.1; // Random percentage between 10% and 50%
                const gambleAmount = money * gamblePercentage;
                money -= gambleAmount;

                if (Math.random() < 0.5) {
                    money += gambleAmount * 2;
                    if (money > MONEY_CAP) {
                        money = MONEY_CAP;  // Cap the money at 100 trillion
                    }
                    alert(`You won the gamble! You now have $${money}`);
                } else {
                    alert(`You lost the gamble! You now have $${money}`);
                }
                moneyDisplay.textContent = money;
                saveData();
            } else {
                alert("You need at least $100 to gamble.");
            }
        };

        document.getElementById("ultimateGambleButton").onclick = function() {
            if (money >= 10000) {
                money -= 10000;
                if (Math.random() < 0.2) {
                    money += 50000;
                    if (money > MONEY_CAP) {
                        money = MONEY_CAP;  // Cap the money at 100 trillion
                    }
                    alert("You won the Ultimate Gamble!");
                } else {
                    alert("You lost the Ultimate Gamble!");
                }
                moneyDisplay.textContent = money;
                saveData();
            } else {
                alert("You need at least $10,000 to participate in the Ultimate Gamble.");
            }
        };

        document.getElementById("startRunButton").onclick = startNewRun;
        document.getElementById("resetButton").onclick = resetEverything;
    </script>
</body>
</html>
